<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="700"
        x:Class="SaveTracker.UC_AddGame"
        xmlns:vm="clr-namespace:SaveTracker.Views.Dialog"
        x:DataType="vm:UC_AddGame_ViewModel"
        Title="Add Game"
        Width="800" Height="500"
        MinWidth="700" MinHeight="400"
        Background="#1E1E1E"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        SystemDecorations="Full">

    <Grid Margin="20" RowDefinitions="Auto,*,Auto">
        
        <!-- Header (Clean Style) -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="Add New Game" FontSize="24" FontWeight="Bold" Foreground="White"/>
            <TextBlock Text="Select a game executable or choose from running processes" 
                      FontSize="13" Foreground="#858585" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Main Content -->
        <Border Grid.Row="1" Margin="0,0,0,20">
            <Grid ColumnDefinitions="*,20,*">
                
                <!-- LEFT COLUMN: Selection & Details -->
                <StackPanel Grid.Column="0" Spacing="20">
                    
                    <!-- Game Selection Method -->
                    <Border Background="#252526" Padding="15" CornerRadius="6">
                        <StackPanel Spacing="15">
                            <TextBlock Text="Select Game Method" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                            
                            <!-- Browse for Executable -->
                            <Button HorizontalAlignment="Stretch" 
                                    Click="OnBrowseExecutable"
                                    Padding="15"
                                    Background="#0E639C"
                                    Height="60">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="📁" FontSize="24" VerticalAlignment="Center"/>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="Browse for Executable" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Select the game's .exe file" 
                                                 FontSize="11" Foreground="#CCCCCC"/>
                                    </StackPanel>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>

                </StackPanel>

                <!-- RIGHT COLUMN: Options & Processes -->
                <StackPanel Grid.Column="2" Spacing="20">
                    
                    <!-- Initial Metadata Alert -->
                    <Border Background="#2D2D30" 
                            BorderBrush="#E3A008" 
                            BorderThickness="1" 
                            CornerRadius="6" 
                            Padding="15">
                         <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12">
                            <TextBlock Text="⚠️" 
                                       FontSize="20" 
                                       VerticalAlignment="Top"/>
                            <StackPanel Grid.Column="1"
                                       VerticalAlignment="Center"  
                                       Spacing="4">
                                <TextBlock Text="Important: Game Name Matters!" 
                                           FontWeight="Bold" 
                                           Foreground="#E3A008" 
                                           FontSize="13"/>
                                <TextBlock Text="This name acts as the UNIQUE ID for cloud backups. Use the same name across devices." 
                                           FontSize="11" 
                                           Foreground="#CCCCCC" 
                                           TextWrapping="WrapWithOverflow"/>
                            </StackPanel>
                         </Grid>
                    </Border>

                   
                    
                    <!-- Selected Game Info -->
                    <Border Background="#252526" Padding="15" CornerRadius="6">
                        <StackPanel Spacing="12">
                            <TextBlock Text="Selected Game Details" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                            
                            <!-- Executable Path -->
                            <StackPanel Spacing="8">
                                <TextBlock Name="ExePathbox" Text="Executable Path:" Foreground="#858585" FontSize="12"/>
                                <TextBox Text="{Binding ExecutablePath}"
                                         IsReadOnly="True" 
                                         Background="#1E1E1E"
                                         BorderBrush="#555555"
                                         Foreground="#CCCCCC"
                                         Padding="10"/>
                            </StackPanel>

                            <!-- Game Name with Cloud Check -->
                            <StackPanel Spacing="8">
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBlock Text="Game Name (Cloud ID):" Foreground="#858585" FontSize="12"/>
                                    <TextBlock Text="{Binding CloudCheckStatus}"
                                              Foreground="{Binding CloudCheckColor}"
                                              FontSize="11"
                                              FontWeight="Bold"
                                              HorizontalAlignment="Right"
                                              VerticalAlignment="Bottom"/>
                                </Grid>
                                
                                <AutoCompleteBox x:Name="GameNameAutoComplete"
                                                 Text="{Binding GameName}"
                                                 FilterMode="StartsWith"
                                                 Watermark="Enter game name to check cloud..."
                                                 MinimumPrefixLength="2"
                                                 MaxDropDownHeight="300">
                                    <AutoCompleteBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" Padding="8,4"/>
                                        </DataTemplate>
                                    </AutoCompleteBox.ItemTemplate>
                                </AutoCompleteBox>
                                
                                <TextBlock FontSize="11" Foreground="#858585" FontStyle="Italic" TextWrapping="Wrap">
    <Run Text="💡 To add an already synced game, type the exact same name"/>
    <LineBreak/>
    <Run Text="💡 Type at least 2 letters to trigger autocompletion"/>
</TextBlock>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>


        <!-- Bottom Action Buttons (Clean Footer) -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10">
             <Button Name="CancelBTN"
                    Click="CancelBTN_Click"
                    Content="Cancel" 
                    Padding="20,10"
                    Background="#3F3F46"
                    Foreground="#CCCCCC"/>
            
            <Button Name="AddGameBTN"
                    Click="AddGameBTN_Click"
                    Content="Add Game" 
                    Padding="20,10"
                    Background="#0E639C"
                    Foreground="White"
                    FontWeight="SemiBold"
                    IsEnabled="True"/>
        </StackPanel>

    </Grid>

    <Window.Styles>
        <Style Selector="Button">
            <Setter Property="Background" Value="#3F3F46"/>
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style Selector="Button:pointerover">
            <Setter Property="Background" Value="#505050"/>
        </Style>
        <Style Selector="Button:disabled">
            <Setter Property="Opacity" Value="0.5"/>
            <Setter Property="Cursor" Value="Arrow"/>
        </Style>
        
        <Style Selector="TextBox">
            <Setter Property="Background" Value="#3F3F46"/>
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        
        <!-- AutoCompleteBox Styling -->
         <Style Selector="AutoCompleteBox">
            <Setter Property="Background" Value="#3F3F46"/>
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        
        <Style Selector="CheckBox">
            <Setter Property="Foreground" Value="#CCCCCC"/>
        </Style>
    </Window.Styles>

</Window>